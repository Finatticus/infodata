<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>FCN 報價管理系統</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
    body { font-family: "Segoe UI", Helvetica, Arial; background: #f6f8fa; margin: 0; padding: 20px; color: #333; }
    h2 { text-align: center; margin-bottom: 25px; color: #2a4d69; font-weight: 600; }
    .upload-box, .filter-box { background: white; border-radius: 12px; padding: 18px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 15px; }
    .filter-buttons { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
    .right-buttons { display: flex; gap: 10px; align-items: center; }
    .upload-box { display: flex; align-items: center; gap: 15px; justify-content: center; }
    input[type="file"] { border: none; background: none; font-size: 15px; }
    button { padding: 6px 20px; background: #2a4d69; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 15px; transition: 0.2s; }
    button.red { background: #b02a37; }
    button:hover { opacity: 0.9; }
    .filter-box input { width: 150px; padding: 8px; border-radius: 6px; border: 1px solid #ccc; margin-right: 10px; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
    th { background: #dbe4ee; padding: 12px; cursor: pointer; text-align: center; font-weight: 600; }
    td { padding: 10px; border-bottom: 1px solid #eee; text-align: center; }
    tr:hover { background: #f0f4f8; }
    .highlight { color: red; font-weight: bold; }
    .section-wrapper { position: relative; }
    .back-btn { position: absolute; left: 20px; top: 0px; background: #ffffff; color: #004c91; border: 2px solid #1f72c6; padding: 7px 16px; border-radius: 8px; cursor: pointer; font-size: 16px; transition: 0.3s; }
    .back-btn:hover { background: #e6f0ff; }
    #pagination { margin-top: 15px; text-align: center; }
    #pagination button { margin: 0 2px; } </style> </head>

<body>
<div class="section-wrapper">
<button class="back-btn" onclick="window.location.href='index.html'">←返回主頁</button>

<h2>FCN 報價統整</h2>

<div class="upload-box">
    <input type="file" id="excelFile">
    <button id="uploadBtn">上傳 Excel</button> </div>

<div class="filter-box">
    <strong>篩選連結股票：</strong><br>（最多五檔，完全相符，例如：NVDA, TSLA）<br><br>
    <input id="stock1" placeholder="股票 1">
    <input id="stock2" placeholder="股票 2">
    <input id="stock3" placeholder="股票 3">
    <input id="stock4" placeholder="股票 4">
    <input id="stock5" placeholder="股票 5">

    <div class="filter-buttons">
        <button onclick="applyStockFilter()">套用篩選</button>
        <div class="right-buttons">
            <label for="rowsPerPageSelect">每頁顯示</label>
            <select id="rowsPerPageSelect" onchange="changeRowsPerPage()">
                <option value="5">5</option>
                <option value="10" selected>10</option>
                <option value="20">20</option>
                <option value="50">50</option>
            </select>
            <button class="red" onclick="clearAll()">清除全部資料</button>
            <button class="red" onclick="deleteSelected()">刪除選取資料</button>
        </div>
    </div>
</div>

<table id="dataTable">
    <thead>
        <tr id="tableHeader">
            <th>選取</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<div id="pagination"></div>

<script>
/* ========= 固定預設資料 ========= */
const defaultRows = [{Date:"2025-11-20",Issuer:"GS",Best:"11.37%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"65%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"TSM",U4:"ORCL",U5:"",UF:"3%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"11.5%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"65%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"TSM",U4:"ORCL",U5:"",UF:"3.2%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"10.66%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"60%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"TSM",U4:"ORCL",U5:"",UF:"3%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"11.36%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"60%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"TSM",U4:"ORCL",U5:"",UF:"3.2%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"10.9%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"65%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"TSM",U4:"PLTR",U5:"",UF:"3%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"10.72%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"65%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"TSM",U4:"PLTR",U5:"",UF:"3.2%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"9.42%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"60%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"TSM",U4:"PLTR",U5:"",UF:"3%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"10.26%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"60%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"TSM",U4:"PLTR",U5:"",UF:"3.2%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"7.35%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"60%",KI:"55%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AAPL",U2:"AMD",U3:"TSM",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"BAR",Best:"2.46%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"60%",KI:"55%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AAPL",U2:"GOOG",U3:"TSM",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"BAR",Best:"1.59%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"60%",KI:"55%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"META",U3:"AMZN",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"7.35%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"60%",KI:"55%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"AMD",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"BAR",Best:"1.2%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"60%",KI:"55%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"AAPL",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"0.96%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"60%",KI:"55%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"MSFT",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"BAR",Best:"2.07%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"60%",KI:"55%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"GOOG",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"BAR",Best:"5.55%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"60%",KI:"55%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AVGO",U2:"TSM",U3:"MSFT",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"BAR",Best:"6.28%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"60%",KI:"55%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"TSM",U2:"AAPL",U3:"AMZN",U4:"INTC",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"0.45%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"60%",KI:"55%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"16.18%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"4",Coupon:"","Coupon Period":"1",Strike:"85%",KI:"45%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"ORCL",U4:"NBIS",U5:"",UF:"2%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"17.73%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"4",Coupon:"","Coupon Period":"1",Strike:"85%",KI:"45%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"NBIS",U4:"",U5:"",UF:"2%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"16.25%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"4",Coupon:"","Coupon Period":"1",Strike:"85%",KI:"45%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"CRWV",U4:"",U5:"",UF:"2%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"12.59%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"","Coupon Period":"1",Strike:"85%",KI:"45%","KI Freq":"EKI",KO:"95%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"ORCL",U4:"NBIS",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"16.52%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"","Coupon Period":"1",Strike:"85%",KI:"45%","KI Freq":"EKI",KO:"95%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"NBIS",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"13.06%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"","Coupon Period":"1",Strike:"85%",KI:"45%","KI Freq":"EKI",KO:"95%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"CRWV",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"10.86%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"","Coupon Period":"1",Strike:"85%",KI:"45%","KI Freq":"EKI",KO:"95%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"ORCL",U4:"NBIS",U5:"",UF:"1.8%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"14.56%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"","Coupon Period":"1",Strike:"85%",KI:"45%","KI Freq":"EKI",KO:"95%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"NBIS",U4:"",U5:"",UF:"1.8%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"11.1%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"","Coupon Period":"1",Strike:"85%",KI:"45%","KI Freq":"EKI",KO:"95%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"CRWV",U4:"",U5:"",UF:"1.8%","T+":"7"},{Date:"2025-11-20",Issuer:"BAR",Best:"3.96%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"AKI",KO:"110%","KO Freq":"Daily","KO Start":"2","Memory KO":"Yes",U1:"TSLA",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"6.52%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"4",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"AKI",KO:"110%","KO Freq":"Daily","KO Start":"2","Memory KO":"Yes",U1:"TSLA",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"8.97%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"5",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"AKI",KO:"110%","KO Freq":"Daily","KO Start":"2","Memory KO":"Yes",U1:"TSLA",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"11.03%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"AKI",KO:"110%","KO Freq":"Daily","KO Start":"2","Memory KO":"Yes",U1:"TSLA",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"BAR",Best:"3.95%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"AKI",KO:"105%","KO Freq":"Daily","KO Start":"2","Memory KO":"Yes",U1:"TSLA",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"6.66%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"4",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"AKI",KO:"105%","KO Freq":"Daily","KO Start":"2","Memory KO":"Yes",U1:"TSLA",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"9.26%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"5",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"AKI",KO:"105%","KO Freq":"Daily","KO Start":"2","Memory KO":"Yes",U1:"TSLA",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"14.5%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"10",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"AKI",KO:"105%","KO Freq":"Daily","KO Start":"2","Memory KO":"Yes",U1:"TSLA",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"11.03%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"AKI",KO:"110%","KO Freq":"Daily","KO Start":"2","Memory KO":"Yes",U1:"TSLA",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"11.03%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"AKI",KO:"110%","KO Freq":"Daily","KO Start":"2","Memory KO":"Yes",U1:"TSLA",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"7.06%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"70%","KI Freq":"EKI",KO:"105%","KO Freq":"Daily","KO Start":"1","Memory KO":"No",U1:"TSM",U2:"",U3:"",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"7%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"60%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"No",U1:"TSM",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"15.18%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"No",U1:"TSM",U2:"NVDA",U3:"PLTR",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"12.1%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"No",U1:"TSM",U2:"NVDA",U3:"TSLA",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"9.59%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"No",U1:"TSM",U2:"NVDA",U3:"AVGO",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"8.22%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"60%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"TSM",U2:"NVDA",U3:"",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"14.22%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"TSM",U2:"NVDA",U3:"PLTR",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"9.96%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"TSM",U2:"NVDA",U3:"TSLA",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"6.97%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"TSM",U2:"NVDA",U3:"AVGO",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"10.12%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSLA",U3:"GOOGL",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"13.82%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"60%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"GOOGL",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"13.38%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"60%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"GOOGL",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"14.54%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"65%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"GOOGL",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"10.6%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"60%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"GOOGL",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"11.25%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"65%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"GOOGL",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"10.06%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"60%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"GOOGL",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"8.94%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"60%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"MSFT",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"8.37%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"60%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"MSFT",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"9.51%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"65%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"MSFT",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"JPM",Best:"10.21%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"70%","KI Freq":"AKI",KO:"110%","KO Freq":"Daily","KO Start":"1","Memory KO":"No",U1:"TSM",U2:"",U3:"",U4:"",U5:"",UF:"1.5%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"43.98%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"","Coupon Period":"1",Strike:"99%",KI:"67%","KI Freq":"AKI",KO:"95%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSLA",U3:"TSM",U4:"PLTR",U5:"",UF:"0.8%","T+":"7"},{Date:"2025-11-20",Issuer:"GS",Best:"0.12%",Solve:"UF",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"0.433","Coupon Period":"1",Strike:"99%",KI:"67%","KI Freq":"AKI",KO:"90%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSLA",U3:"TSM",U4:"PLTR",U5:"",UF:"0%","T+":"7"},{Date:"2025-11-21",Issuer:"Nomura",Best:"15.89%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"MU",U4:"",U5:"",UF:"2.5%","T+":"8"},{Date:"2025-11-21",Issuer:"BAR",Best:"5.03%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"CCL",U4:"",U5:"",UF:"2.5%","T+":"8"},{Date:"2025-11-21",Issuer:"BAR",Best:"7.76%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"AAL",U4:"",U5:"",UF:"2.5%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"13.71%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"MU",U4:"",U5:"",UF:"3%","T+":"8"},{Date:"2025-11-21",Issuer:"BAR",Best:"3.09%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"CCL",U4:"",U5:"",UF:"3%","T+":"8"},{Date:"2025-11-21",Issuer:"BAR",Best:"5.83%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"50%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"AAL",U4:"",U5:"",UF:"3%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"23.84%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"60%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"AMD",U4:"",U5:"",UF:"0.8%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"30.32%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"60%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"PLTR",U3:"AMD",U4:"",U5:"",UF:"0.8%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"20.82%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"60%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"PLTR",U3:"AMD",U4:"",U5:"",UF:"3%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"14.46%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"60%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"AVGO",U3:"AMD",U4:"",U5:"",UF:"3%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"13.33%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"60%","KI Freq":"EKI",KO:"95%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"MU",U2:"TSM",U3:"",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"11.45%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"EKI",KO:"95%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"MU",U2:"TSM",U3:"",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"13.78%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"60%","KI Freq":"EKI",KO:"92%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"MU",U2:"TSM",U3:"",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"13.02%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"73%",KI:"60%","KI Freq":"EKI",KO:"92%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"MU",U2:"TSM",U3:"",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"11.77%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"60%","KI Freq":"EKI",KO:"92%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"MU",U2:"TSM",U3:"",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"10.05%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"EKI",KO:"92%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"MU",U2:"TSM",U3:"",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"12.39%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"60%","KI Freq":"EKI",KO:"90%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"MU",U2:"TSM",U3:"",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"11.65%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"73%",KI:"60%","KI Freq":"EKI",KO:"90%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"MU",U2:"TSM",U3:"",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"10.43%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"60%","KI Freq":"EKI",KO:"90%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"MU",U2:"TSM",U3:"",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"BAR",Best:"8.91%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"55%","KI Freq":"EKI",KO:"90%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"MU",U2:"TSM",U3:"",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"19.91%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"NA%","KI Freq":"NA",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSLA",U3:"",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"22.27%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"NA%","KI Freq":"NA",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSLA",U3:"",U4:"",U5:"",UF:"1.5%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"11.82%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"7",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"70%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"GOOG",U2:"NVDA",U3:"SPY",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"11.8%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"7",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"70%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"GOOG",U2:"NVDA",U3:"QQQ",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"11.81%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"7",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"70%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"GOOG",U2:"NVDA",U3:"VOO",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"11.98%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"8",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"70%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"GOOG",U2:"NVDA",U3:"SPY",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"11.99%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"8",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"70%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"GOOG",U2:"NVDA",U3:"QQQ",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"12.01%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"8",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"70%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"GOOG",U2:"NVDA",U3:"VOO",U4:"",U5:"",UF:"2%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"12.75%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"9",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"70%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"GOOG",U2:"NVDA",U3:"SPY",U4:"",U5:"",UF:"1.8%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"12.71%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"9",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"70%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"GOOG",U2:"NVDA",U3:"QQQ",U4:"",U5:"",UF:"1.8%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"12.73%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"9",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"70%","KI Freq":"AKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"GOOG",U2:"NVDA",U3:"VOO",U4:"",U5:"",UF:"1.8%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"29.03%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"4",Coupon:"","Coupon Period":"1",Strike:"90%",KI:"80%","KI Freq":"EKI",KO:"110%","KO Freq":"Daily","KO Start":"1","Memory KO":"No",U1:"TSLA",U2:"",U3:"",U4:"",U5:"",UF:"0.8%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"26.76%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"4",Coupon:"","Coupon Period":"1",Strike:"90%",KI:"80%","KI Freq":"EKI",KO:"110%","KO Freq":"Daily","KO Start":"2","Memory KO":"No",U1:"TSLA",U2:"",U3:"",U4:"",U5:"",UF:"0.8%","T+":"8"},{Date:"2025-11-21",Issuer:"BAR",Best:"25.03%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"4",Coupon:"","Coupon Period":"1",Strike:"90%",KI:"80%","KI Freq":"EKI",KO:"110%","KO Freq":"Daily","KO Start":"3","Memory KO":"No",U1:"TSLA",U2:"",U3:"",U4:"",U5:"",UF:"0.8%","T+":"8"},{Date:"2025-11-21",Issuer:"BAR",Best:"18.72%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"","Coupon Period":"1",Strike:"90%",KI:"70%","KI Freq":"EKI",KO:"110%","KO Freq":"Daily","KO Start":"2","Memory KO":"No",U1:"TSLA",U2:"",U3:"",U4:"",U5:"",UF:"0.8%","T+":"8"},{Date:"2025-11-21",Issuer:"BAR",Best:"16.92%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"2",Coupon:"","Coupon Period":"1",Strike:"90%",KI:"70%","KI Freq":"EKI",KO:"110%","KO Freq":"Daily","KO Start":"1","Memory KO":"No",U1:"TSLA",U2:"",U3:"",U4:"",U5:"",UF:"0.8%","T+":"8"},{Date:"2025-11-21",Issuer:"BAR",Best:"23.01%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"3",Coupon:"","Coupon Period":"1",Strike:"90%",KI:"75%","KI Freq":"EKI",KO:"110%","KO Freq":"Daily","KO Start":"2","Memory KO":"No",U1:"TSLA",U2:"",U3:"",U4:"",U5:"",UF:"0.8%","T+":"8"},{Date:"2025-11-21",Issuer:"BAR",Best:"22.68%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"2",Coupon:"","Coupon Period":"1",Strike:"90%",KI:"75%","KI Freq":"EKI",KO:"110%","KO Freq":"Daily","KO Start":"1","Memory KO":"No",U1:"TSLA",U2:"",U3:"",U4:"",U5:"",UF:"0.8%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"41.15%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"50%","KI Freq":"EKI",KO:"999%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AVGO",U2:"ALAB",U3:"BE",U4:"CRDO",U5:"",UF:"1.5%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"38.45%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"9",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"50%","KI Freq":"EKI",KO:"999%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AVGO",U2:"ALAB",U3:"BE",U4:"CRDO",U5:"",UF:"1.5%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"35.43%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"50%","KI Freq":"EKI",KO:"999%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AVGO",U2:"ALAB",U3:"BE",U4:"CRDO",U5:"",UF:"1.5%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"38.82%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"50%","KI Freq":"EKI",KO:"999%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AVGO",U2:"BE",U3:"CRDO",U4:"DELL",U5:"",UF:"1.5%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"36.18%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"9",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"50%","KI Freq":"EKI",KO:"999%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AVGO",U2:"BE",U3:"CRDO",U4:"DELL",U5:"",UF:"1.5%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"33.64%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"50%","KI Freq":"EKI",KO:"999%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AVGO",U2:"BE",U3:"CRDO",U4:"DELL",U5:"",UF:"1.5%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"38.41%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"6",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"50%","KI Freq":"EKI",KO:"999%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AVGO",U2:"BE",U3:"CRDO",U4:"",U5:"",UF:"1.5%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"36.02%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"9",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"50%","KI Freq":"EKI",KO:"999%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AVGO",U2:"BE",U3:"CRDO",U4:"",U5:"",UF:"1.5%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"33.51%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"50%","KI Freq":"EKI",KO:"999%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"AVGO",U2:"BE",U3:"CRDO",U4:"",U5:"",UF:"1.5%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"35.66%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"100%",KI:"NA%","KI Freq":"NA",KO:"120%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"SMCI",U4:"",U5:"",UF:"0.6%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"31.63%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"90%",KI:"NA%","KI Freq":"NA",KO:"120%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"SMCI",U4:"",U5:"",UF:"0.6%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"27.29%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"NA%","KI Freq":"NA",KO:"120%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"SMCI",U4:"",U5:"",UF:"0.6%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"22.8%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"70%",KI:"NA%","KI Freq":"NA",KO:"120%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"SMCI",U4:"",U5:"",UF:"0.6%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"25%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"100%",KI:"NA%","KI Freq":"NA",KO:"120%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"",U4:"",U5:"",UF:"0.6%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"20.62%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"90%",KI:"NA%","KI Freq":"NA",KO:"120%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"",U4:"",U5:"",UF:"0.6%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"16.32%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"80%",KI:"NA%","KI Freq":"NA",KO:"120%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"",U4:"",U5:"",UF:"0.6%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"14.29%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"NA%","KI Freq":"NA",KO:"120%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"NVDA",U2:"TSM",U3:"",U4:"",U5:"",UF:"0.6%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"20.58%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"100%",KI:"NA%","KI Freq":"NA",KO:"120%","KO Freq":"Daily","KO Start":"1","Memory KO":"No",U1:"TSM",U2:"",U3:"",U4:"",U5:"",UF:"0.6%","T+":"8"},{Date:"2025-11-21",Issuer:"JPM",Best:"16.51%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"90%",KI:"NA%","KI Freq":"NA",KO:"120%","KO Freq":"Daily","KO Start":"1","Memory KO":"No",U1:"TSM",U2:"",U3:"",U4:"",U5:"",UF:"0.6%","T+":"8"},{Date:"2025-11-21",Issuer:"Nomura",Best:"17.86%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"55%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"PLTR",U2:"AVGO",U3:"NVDA",U4:"",U5:"",UF:"2.3%","T+":"8"},{Date:"2025-11-21",Issuer:"GS",Best:"18.11%",Solve:"Coupon",Type:"FCN",Currency:"USD","Tenor (M)":"12",Coupon:"","Coupon Period":"1",Strike:"75%",KI:"55%","KI Freq":"EKI",KO:"100%","KO Freq":"Daily","KO Start":"1","Memory KO":"Yes",U1:"PLTR",U2:"ARM",U3:"NVDA",U4:"",U5:"",UF:"2.3%","T+":"8"}


];



let allRows = [];
let filteredRows = [];
let lastSort = { col: null, asc: true };

// 分頁
let currentPage = 1;
let rowsPerPage = 30;

const percentCols = ["Best", "Strike", "KI", "KO Start", "UF"]; const stockCols = ["U1","U2","U3","U4","U5"];

window.onload = function () {
    const saved = localStorage.getItem("fcnData");
    if (saved) allRows = JSON.parse(saved);
    else { allRows = [...defaultRows]; localStorage.setItem("fcnData", JSON.stringify(allRows)); }
    filteredRows = [...allRows];
    renderTable(filteredRows);
};

// 上傳 Excel
document.getElementById("uploadBtn").addEventListener("click", function () {
    const fileInput = document.getElementById("excelFile");
    if (!fileInput.files.length) return alert("請選擇Excel 檔案");
    const file = fileInput.files[0];
    const reader = new FileReader();
    reader.onload = function (e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: "array" });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        let rows = XLSX.utils.sheet_to_json(sheet, { defval: "" });
        rows = rows.map(row => {
            if (row.Date) row.Date = XLSX.SSF.format("yyyy-mm-dd", row.Date);
            percentCols.forEach(c => { if (row[c] !== "" && !isNaN(row[c])) row[c] = (row[c]*100).toFixed(2) + "%"; });
            if (row["Coupon Period"] == 1) row["Coupon Period"] = "Monthly";
            return row;
        });
        allRows = allRows.concat(rows);
        filteredRows = [...allRows];
        localStorage.setItem("fcnData", JSON.stringify(allRows));
        currentPage = 1;
        renderTable(filteredRows);
    };
    reader.readAsArrayBuffer(file);
});

// 每頁顯示下拉
function changeRowsPerPage() { 
    const select = document.getElementById("rowsPerPageSelect");
    rowsPerPage = parseInt(select.value); 
    currentPage = 1; 
    renderTable(filteredRows);
}

// renderTable
function renderTable(rows) {
    const tbody = document.querySelector("tbody");
    tbody.innerHTML = "";
    if (rows.length === 0) return;

    const header = Object.keys(rows[0]);
    const thead = document.getElementById("tableHeader");
    thead.innerHTML = "<th>選取</th>";
    header.forEach(col => {
        const th = document.createElement("th");
        th.textContent = col;
        th.onclick = () => sortBy(col);
        thead.appendChild(th);
    });

    const start = (currentPage - 1) * rowsPerPage;
    const end = start + rowsPerPage;
    const pageRows = rows.slice(start, end);

    pageRows.forEach((row, idx) => {
        const tr = document.createElement("tr");
        const chk = document.createElement("td");
        chk.innerHTML = `<input type="checkbox" class="rowCheck" data-id="${start + idx}">`;
        tr.appendChild(chk);
        header.forEach(col => {
            const td = document.createElement("td");
            td.textContent = row[col];
            const searchList = [stock1.value.trim(),stock2.value.trim(),stock3.value.trim(),stock4.value.trim(),stock5.value.trim()].filter(x=>x);
            if(stockCols.includes(col) && searchList.includes(row[col])) td.classList.add("highlight");
            tr.appendChild(td);
        });
        tbody.appendChild(tr);
    });

    renderPagination(rows.length);
}

// 分頁按鈕
function renderPagination(totalRows){
    const pagination = document.getElementById("pagination");
    pagination.innerHTML = "";
    const totalPages = Math.ceil(totalRows/rowsPerPage);
    if(totalPages <=1) return;

    const firstBtn=document.createElement("button");
    firstBtn.textContent="第一頁";
    firstBtn.disabled = currentPage===1;
    firstBtn.onclick = ()=>{currentPage=1; renderTable(filteredRows);}
    pagination.appendChild(firstBtn);

    const prevBtn=document.createElement("button");
    prevBtn.textContent="上一頁";
    prevBtn.disabled=currentPage===1;
    prevBtn.onclick=()=>{currentPage--; renderTable(filteredRows);}
    pagination.appendChild(prevBtn);

    let startPage=Math.max(1,currentPage-2);
    let endPage=Math.min(totalPages,startPage+4);
    if(endPage-startPage<4) startPage=Math.max(1,endPage-4);

    for(let i=startPage;i<=endPage;i++){
        const btn=document.createElement("button");
        btn.textContent=i;
        btn.style.fontWeight=currentPage===i?"bold":"normal";
        btn.onclick=()=>{currentPage=i; renderTable(filteredRows);}
        pagination.appendChild(btn);
    }

    const nextBtn=document.createElement("button");
    nextBtn.textContent="下一頁";
    nextBtn.disabled=currentPage===totalPages;
    nextBtn.onclick=()=>{currentPage++; renderTable(filteredRows);}
    pagination.appendChild(nextBtn);

    const lastBtn=document.createElement("button");
    lastBtn.textContent="最後一頁";
    lastBtn.disabled=currentPage===totalPages;
    lastBtn.onclick=()=>{currentPage=totalPages; renderTable(filteredRows);}
    pagination.appendChild(lastBtn);
}

// 篩選
function applyStockFilter(){
    const inputs=[stock1.value.trim(),stock2.value.trim(),stock3.value.trim(),stock4.value.trim(),stock5.value.trim()].filter(x=>x);
    if(inputs.length===0) filteredRows=[...allRows];
    else filteredRows=allRows.filter(row=>inputs.every(stk=>stockCols.some(col=>row[col]===stk)));
    currentPage=1;
    renderTable(filteredRows);
}

// 刪除選取
function deleteSelected(){
    const checks=document.querySelectorAll(".rowCheck:checked");
    if(checks.length===0){alert("請先勾選要刪除的資料"); return;}
    if(!confirm(`確定要刪除 ${checks.length} 筆選取資料？`)) return;
    const deleteIds=[...checks].map(x=>Number(x.dataset.id));
    allRows=allRows.filter((row,idx)=>!deleteIds.includes(idx));
    filteredRows=[...allRows];
    localStorage.setItem("fcnData",JSON.stringify(allRows));
    currentPage=1;
    renderTable(filteredRows);
}

// 清除全部
function clearAll(){
    if(!confirm("確定清除所有資料？")) return;
    allRows=[...defaultRows];
    filteredRows=[...allRows];
    localStorage.setItem("fcnData",JSON.stringify(allRows));
    currentPage=1;
    renderTable(filteredRows);
}

// 排序
function sortBy(col){
    if(lastSort.col===col) lastSort.asc=!lastSort.asc;
    else lastSort={col,asc:true};
    filteredRows.sort((a,b)=>{
        let x=a[col],y=b[col];
        if(typeof x==="string" && x.endsWith("%")) x=parseFloat(x);
        if(typeof y==="string" && y.endsWith("%")) y=parseFloat(y);
        return lastSort.asc?(x>y?1:-1):(x<y?1:-1);
    });
    renderTable(filteredRows);
}
</script>
</body>
</html>


